# 05. AWS ELB＆Lambda

# 1. ELB (Elastic Load Balancing)

---

EC2 インスタンスを複数の AZ に配置して、ユーザーからの単一アクセスを受け付けるようにするために使うことのできるサービスが ELB です。ELB を使用することで、同じ構成を持った 2 つの EC2 インスタンスを別々の AZ に配置することができます。そして ELB はその２つの EC2 インスタンスに、ユーザーからのリクエストトラフィックを分散します。高可用性・耐障害性を向上することができる。

## 1) ELB の特徴

---

1. ロードバランサータイプ：ELB には 3 つのタイプがあります。

   - Application Load Balancer: HTTP または HTTPS のリクエストを負荷分散する用途で選択します。Web Application に対して高度な機能が提供されます。
   - Network Load Balancer: HTTP, HTTPS 以外の TCP プロトコルを使用する場合に選択します。1 秒あたりの数百万のリクエストを処理することができます。
   - Classic Load Balancer: いぜんのタイプロードバランサーです。

   → HTTP/HTTPS では Application Load Balancer, それ以外の TCP では Network Load Balancer 使用

## 2) ヘルスチェック

---

ELB はターゲットとしているインスタンスが正常かどうかのヘルスチェックを行い、正常なインスタンス飲みにリクエストを送るように動作します。そうすることでユーザーが以上なインスタンスにアクセスしてしまうことを防いでいます。

## 3) 高可用性のマネージドサービス

---

ELB を使うことで EC2 の高可用性を実現できます。でも、もし ELB 自体が壊れた場合(SPOF)はどうなるのでしょうか。例えば複数の AZ に ELB を配置していると想定し、SPOF になったとします。この時、内部的には ELB のノードと呼ばれるインスタンスが複数起動して、ユーザーからのリクエストを受け付けて負荷分散しています。ここでキーポイントは ELB 自体が高可用性のマネージドサービスなので、単一障害点とはなりません。

## 4) クロスゾーン負荷分散

---

Application Load Balancer で常に有効、Network Load Balancer で有効/無効を洗濯できる機能にクロスゾーン負荷分散というものがあります。複数の AZni 負荷分散を実行できるので、リソースの負荷が均等になります。

## 5) Auto Scaling

---

Auto Scaling によって EC2 インスタンスを必要な時に自動で増減できるます。なお、このメリットとしては、高可用性・耐障害性・コスト効率化があります。

## 6) 垂直スケーリングと水平スケーリング

---

インスタンスの数の増減でスケーリングをすることを水平スケーリングと呼び、上限はないです。

逆に、一つのスペックをアップグレードさせることを垂直スケーリングと言います。検証や停止が必要であり、インスタンスの最大サイズまで増減できるので、枠やサイズが決まっています。つまり、水平スケーリングの方がスケーラビリティを確保しやすいです。

# 2. AWS Lambda

---

AWS Lambda は、ソースコードさえ用意すれば、そのプログラムを実行することができるサービスです。プログラムを実行するための環境を構築する必要も管理する必要もありません。サーバーレスを実現できます。

## 1) 特徴

---

1. サーバー構築・管理不要
2. 一般的な言語のサポート
3. 並列処理とスケーリング
4. 柔軟なリソース設定
5. ミリ秒単位の無駄のない課金
6. 他の AWS サービスと連携可能
